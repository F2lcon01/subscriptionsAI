<!DOCTYPE html>
<html lang="en" dir="ltr" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ â€” ØªØªØ¨Ù‘Ø¹ ÙƒÙ„ Ø§Ø´ØªØ±Ø§ÙƒØŒ ÙˆÙÙ‘Ø± ÙƒÙ„ Ø±ÙŠØ§Ù„. Ù…Ù†ØµØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª.">
  <meta name="theme-color" content="#7C3AED">

  <!-- Open Graph -->
  <meta property="og:title" content="Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ â€” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª">
  <meta property="og:description" content="ØªØªØ¨Ù‘Ø¹ ÙƒÙ„ Ø§Ø´ØªØ±Ø§ÙƒØŒ ÙˆÙÙ‘Ø± ÙƒÙ„ Ø±ÙŠØ§Ù„. Ù…Ø¬Ø§Ù†ÙŠØ© ÙˆÙ…ÙØªÙˆØ­Ø© Ø§Ù„Ù…ØµØ¯Ø±.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="assets/images/og-image.png">

  <!-- Prevent theme flash â€” must run before DOM render -->
  <script>
    (function() {
      var theme = localStorage.getItem('subtracker-theme');
      var lang = localStorage.getItem('subtracker-lang');
      if (!theme) {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      }
      document.documentElement.setAttribute('data-theme', theme);
      document.documentElement.setAttribute('lang', lang || 'en');
      document.documentElement.setAttribute('dir', (lang === 'ar') ? 'rtl' : 'ltr');
    })();
  </script>

  <title>Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/auth.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/subscriptions.css">
  <link rel="stylesheet" href="css/modal.css">
  <link rel="stylesheet" href="css/settings.css">
  <link rel="stylesheet" href="css/reports.css">
  <link rel="stylesheet" href="css/calendar.css">
  <link rel="stylesheet" href="css/tools.css">
  <link rel="stylesheet" href="css/sharing.css">
  <link rel="stylesheet" href="css/wrapped.css">
  <link rel="stylesheet" href="css/ai-chat.css">
  <link rel="stylesheet" href="css/responsive.css">
  <link rel="stylesheet" href="css/animations.css">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32.png">
</head>
<body>
  <!-- ============================================
       AUTH SECTION â€” Login / Register
       ============================================ -->
  <section id="auth-section" class="auth" hidden>
    <!-- Populated by auth module -->
  </section>

  <!-- ============================================
       APP SECTION â€” Main Application Shell
       ============================================ -->
  <section id="app-section" class="app" hidden>
    <!-- Header -->
    <header class="app__header" id="app-header">
      <div class="app__header-start">
        <button class="app__menu-btn" id="menu-toggle-btn" aria-label="Toggle menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>
        <h1 class="app__logo">
          <span class="app__logo-icon">ðŸ“Š</span>
          <span data-i18n="app.name">SubTracker</span>
        </h1>
      </div>
      <div class="app__header-end">
        <!-- Language Toggle -->
        <button class="header-btn" id="lang-toggle-btn" aria-label="Toggle language">
          <span id="lang-label">Ø¹Ø±Ø¨ÙŠ</span>
        </button>
        <!-- Theme Toggle -->
        <button class="header-btn" id="theme-toggle-btn" aria-label="Toggle theme">
          <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        <!-- User Menu -->
        <button class="header-btn header-btn--avatar" id="user-menu-btn" aria-label="User menu">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </button>
        <!-- User Dropdown -->
        <div class="dropdown" id="user-dropdown" hidden>
          <div class="dropdown__header">
            <span class="dropdown__name" id="user-display-name"></span>
            <span class="dropdown__email" id="user-display-email"></span>
          </div>
          <hr class="dropdown__divider">
          <button class="dropdown__item" id="logout-btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            <span data-i18n="auth.logout">Logout</span>
          </button>
        </div>
      </div>
    </header>

    <!-- Sidebar (Desktop) -->
    <aside class="sidebar" id="sidebar">
      <nav class="sidebar__nav" aria-label="Main navigation">
        <a href="#/dashboard" class="sidebar__link sidebar__link--active" data-page="dashboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          <span data-i18n="nav.dashboard">Dashboard</span>
        </a>
        <a href="#/subscriptions" class="sidebar__link" data-page="subscriptions">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="8" y1="6" x2="21" y2="6"></line>
            <line x1="8" y1="12" x2="21" y2="12"></line>
            <line x1="8" y1="18" x2="21" y2="18"></line>
            <line x1="3" y1="6" x2="3.01" y2="6"></line>
            <line x1="3" y1="12" x2="3.01" y2="12"></line>
            <line x1="3" y1="18" x2="3.01" y2="18"></line>
          </svg>
          <span data-i18n="nav.subscriptions">Subscriptions</span>
        </a>
        <a href="#/calendar" class="sidebar__link" data-page="calendar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          <span data-i18n="nav.calendar">Calendar</span>
        </a>
        <a href="#/reports" class="sidebar__link" data-page="reports">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="20" x2="18" y2="10"></line>
            <line x1="12" y1="20" x2="12" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="14"></line>
          </svg>
          <span data-i18n="nav.reports">Reports</span>
        </a>
        <a href="#/tools" class="sidebar__link" data-page="tools">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
          </svg>
          <span data-i18n="nav.tools">Tools</span>
        </a>
        <a href="#/settings" class="sidebar__link" data-page="settings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
          <span data-i18n="nav.settings">Settings</span>
        </a>
      </nav>
    </aside>

    <!-- Sidebar Overlay (Mobile) -->
    <div class="sidebar-overlay" id="sidebar-overlay" hidden></div>

    <!-- Main Content Area -->
    <main class="app__main" id="main-content">
      <!-- Pages loaded dynamically -->
      <div class="page page--dashboard" id="page-dashboard">
        <div class="page__header">
          <h2 class="page__title" data-i18n="nav.dashboard">Dashboard</h2>
        </div>
        <div class="page__body">
          <!-- Dashboard content will be added in Phase 1B -->
          <div class="empty-state">
            <div class="empty-state__icon">ðŸ“Š</div>
            <h3 class="empty-state__title" data-i18n="dashboard.empty_title">Welcome to Ø§Ø´ØªØ±Ø§ÙƒØ§ØªÙŠ!</h3>
            <p class="empty-state__text" data-i18n="dashboard.empty_text">Start by adding your first subscription to track your expenses.</p>
          </div>
        </div>
      </div>

      <div class="page page--subscriptions" id="page-subscriptions" hidden>
        <div class="page__header">
          <h2 class="page__title" data-i18n="nav.subscriptions">Subscriptions</h2>
        </div>
        <div class="page__body">
          <div class="empty-state">
            <div class="empty-state__icon">ðŸ“‹</div>
            <h3 class="empty-state__title" data-i18n="subscriptions.empty_title">No subscriptions yet</h3>
            <p class="empty-state__text" data-i18n="subscriptions.empty_text">Add your first subscription to get started.</p>
          </div>
        </div>
      </div>

      <div class="page page--calendar" id="page-calendar" hidden></div>

      <div class="page page--reports" id="page-reports" hidden></div>

      <div class="page page--tools" id="page-tools" hidden></div>

      <div class="page page--admin" id="page-admin" hidden></div>

      <div class="page page--settings" id="page-settings" hidden>
        <div class="page__header">
          <h2 class="page__title" data-i18n="nav.settings">Settings</h2>
        </div>
        <div class="page__body" id="settings-body"></div>
      </div>
    </main>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav" id="bottom-nav" aria-label="Mobile navigation">
      <a href="#/dashboard" class="bottom-nav__item bottom-nav__item--active" data-page="dashboard">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        <span data-i18n="nav.dashboard">Dashboard</span>
      </a>
      <a href="#/subscriptions" class="bottom-nav__item" data-page="subscriptions">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="8" y1="6" x2="21" y2="6"></line>
          <line x1="8" y1="12" x2="21" y2="12"></line>
          <line x1="8" y1="18" x2="21" y2="18"></line>
          <line x1="3" y1="6" x2="3.01" y2="6"></line>
          <line x1="3" y1="12" x2="3.01" y2="12"></line>
          <line x1="3" y1="18" x2="3.01" y2="18"></line>
        </svg>
        <span data-i18n="nav.subscriptions">Subscriptions</span>
      </a>
      <a href="#/calendar" class="bottom-nav__item" data-page="calendar">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        <span data-i18n="nav.calendar">Calendar</span>
      </a>
      <a href="#/reports" class="bottom-nav__item" data-page="reports">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="20" x2="18" y2="10"></line>
          <line x1="12" y1="20" x2="12" y2="4"></line>
          <line x1="6" y1="20" x2="6" y2="14"></line>
        </svg>
        <span data-i18n="nav.reports">Reports</span>
      </a>
      <a href="#/settings" class="bottom-nav__item" data-page="settings">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
        </svg>
        <span data-i18n="nav.settings">Settings</span>
      </a>
    </nav>
  </section>

  <!-- Offline Banner -->
  <div class="offline-banner" id="offline-banner" hidden>
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="1" y1="1" x2="23" y2="23"></line><path d="M16.72 11.06A10.94 10.94 0 0 1 19 12.55"></path><path d="M5 12.55a10.94 10.94 0 0 1 5.17-2.39"></path><path d="M10.71 5.05A16 16 0 0 1 22.56 9"></path><path d="M1.42 9a15.91 15.91 0 0 1 4.7-2.88"></path><path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path><line x1="12" y1="20" x2="12.01" y2="20"></line></svg>
    <span data-i18n="common.offline">You are offline</span>
  </div>

  <!-- Panic Lock Screen -->
  <div class="panic-lock" id="panic-lock-screen" hidden>
    <div class="panic-lock__icon">ðŸ”’</div>
    <h2 class="panic-lock__title" data-i18n="panic.locked">Application Locked</h2>
    <div class="panic-lock__form">
      <input type="password" class="input" id="panic-unlock-input" placeholder="Master password" data-i18n-placeholder="panic.enter_password">
      <button class="btn btn--primary" id="panic-unlock-btn" data-i18n="panic.unlock">Unlock</button>
    </div>
  </div>

  <!-- Toast Notifications Container -->
  <div class="toast-container" id="toast-container" aria-live="polite"></div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    <div class="loading-overlay__spinner">
      <div class="loading-overlay__dot"></div>
      <div class="loading-overlay__dot"></div>
      <div class="loading-overlay__dot"></div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-messaging-compat.js"></script>

  <!-- CDN Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <!-- App Scripts â€” Core -->
  <script src="js/config/firebase.js"></script>
  <script src="js/modules/i18n.js"></script>
  <script src="js/modules/theme.js"></script>
  <script src="js/modules/router.js"></script>
  <script src="js/modules/toast.js"></script>

  <!-- Security -->
  <script src="js/services/crypto.js"></script>
  <script src="js/modules/panic-mode.js"></script>

  <!-- Auth & Data -->
  <script src="js/services/auth.js"></script>
  <script src="js/services/subscriptions.js"></script>

  <!-- Services -->
  <script src="js/services/currency.js"></script>
  <script src="js/services/logo-service.js"></script>
  <script src="js/services/notifications.js"></script>
  <script src="js/services/insights.js"></script>
  <script src="js/services/alerts.js"></script>
  <script src="js/services/gamification.js"></script>
  <script src="js/services/sharing.js"></script>
  <script src="js/services/export.js"></script>
  <script src="js/services/import.js"></script>
  <script src="js/services/ai-companion.js"></script>

  <!-- Page Modules -->
  <script src="js/modules/dashboard.js"></script>
  <script src="js/modules/subscription-modal.js"></script>
  <script src="js/modules/subscription-list.js"></script>
  <script src="js/modules/reports.js"></script>
  <script src="js/modules/calendar.js"></script>
  <script src="js/modules/mini-apps.js"></script>
  <script src="js/modules/social-share.js"></script>
  <script src="js/modules/yearly-wrapped.js"></script>
  <script src="js/modules/admin.js"></script>
  <script src="js/modules/settings.js"></script>

  <!-- App Entry Point -->
  <script src="js/app.js"></script>

  <!-- Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/subscriptionsAI/sw.js')
          .then(function(reg) { console.log('SW registered:', reg.scope); })
          .catch(function(err) { console.warn('SW registration failed:', err); });
      });
    }
  </script>
</body>
</html>
